<!DOCTYPE html><html>
  <head>
    <title>Gravitule</title>
  </head>
  <body>
    <canvas id="content" width="800" height="600"></canvas>
    <script>
      function $(a){return document.getElementById(a)}
      Math.squared = (a) => {return a*a}
      let canvas = $("content");
      let ctx = canvas.getContext("2d");
      let circles = [];
      class circle{
        constructor(x,y,r,fill){
          this.x = x;
          this.y = y;
          this.r = r;
          this.velocity = 1;
          this.dist = 20;
          this.angle = 0;
          this.allowForce = true;
          this.fill = fill;
          circles = [...circles, this];
        }
        draw(){
          ctx.beginPath();
          ctx.arc(this.x,this.y,this.r,0,2*Math.PI);
          ctx.fillStyle = this.fill;
          ctx.fill();
        }
        attract(x2,y2,stopDist){
          let ylen = y2-this.y;
          let xlen = x2-this.x;
          let angle = Math.atan2(ylen,xlen) * 180/Math.PI;
          this.dist = Math.sqrt(Math.squared(xlen) + Math.squared(ylen));
          if(this.dist > stopDist && this.velocity > 0)this.velocity-=0.01;
          if(this.dist < stopDist){this.velocity = 1; return;}
          this.angle = angle;
          this.x+=Math.cos(this.angle)*this.velocity;
          this.y+=Math.sin(this.angle)*this.velocity;
        }
      }
      //let angle = Math.atan2(y2-y1,x2-x1) * 180/Math.PI;
      let c1 = new circle(400,300,10,"red");
      let c2 = new circle(100,100,30,"orange");
      function draw(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        circles.forEach(circle => {circle.draw();});
        c1.attract(c2.x,c2.y,10);
        //console.log(`x: ${c1.x}, y:{c1.y}, angle: ${c1.angle}, dist: ${c1.dist}`);
        setTimeout(draw,2);
      }
      draw();
    </script>
  </body>
</html>
